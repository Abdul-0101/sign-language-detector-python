<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Sign Language Detector</title>
  <style>
    /* your styles here */
  </style>
</head>
<body>
  <video id="input_video" autoplay muted playsinline width="640" height="480"></video>
  <canvas id="output_canvas" width="640" height="480"></canvas>

  <script type="module">
    import { Hands } from "@mediapipe/hands";
    import { Camera } from "@mediapipe/camera_utils";

    // Helper to check for SIMD support
    async function supportsSIMD() {
      if (!WebAssembly.validate) return false;
      try {
        const response = await fetch("/hands_solution_simd_wasm_bin.wasm");
        const buffer = await response.arrayBuffer();
        return WebAssembly.validate(buffer);
      } catch {
        return false;
      }
    }

    (async () => {
      const useSimd = await supportsSIMD();

      const hands = new Hands({
        locateFile: (file) => {
          // all four files must live in `static/`
          return `/${file}`;
        }
      });

      // If SIMD isn't supported, point to the fallback build
      if (!useSimd) {
        hands.setOptions({
          solutionPath: "/hands_solution_wasm_bin.js"
        });
      }

      hands.setOptions({
        maxNumHands: 1,
        modelComplexity: 1,
        minDetectionConfidence: 0.7,
        minTrackingConfidence: 0.5
      });

      hands.onResults((results) => {
        // your onResults handler:
        const canvas = document.getElementById("output_canvas");
        const ctx = canvas.getContext("2d");
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        // draw results.multiHandLandmarks, etc.
      });

      const videoElement = document.getElementById("input_video");
      const camera = new Camera(videoElement, {
        onFrame: async () => {
          await hands.send({ image: videoElement });
        },
        width: 640,
        height: 480
      });
      camera.start();
    })();
  </script>
</body>
</html>
